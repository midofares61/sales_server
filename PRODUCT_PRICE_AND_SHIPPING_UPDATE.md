# ๐ฆ ุชุญุฏูุซ: ุฅุถุงูุฉ ุงูุณุนุฑ ููููุชุฌุงุช ูุงูุดุญู ููุทูุจุงุช

## ๐ ููุฎุต ุงูุชุญุฏูุซุงุช

ุชู ุฅุถุงูุฉ ุญูููู ุฌุฏูุฏูู:
1. **`price`** ูู ุฌุฏูู Products - ูุชุฎุฒูู ุณุนุฑ ุงูููุชุฌ
2. **`shipping`** ูู ุฌุฏูู Orders - ูุชุฎุฒูู ูุตุงุฑูู ุงูุดุญู

---

## ๐๏ธ ุชุบููุฑุงุช Database

### Products Table
```sql
ALTER TABLE products 
ADD COLUMN price DECIMAL(10,2) NOT NULL DEFAULT 0 
COMMENT 'ุณุนุฑ ุงูููุชุฌ';
```

**ุงูุฎุตุงุฆุต:**
- ุงูููุน: `DECIMAL(10,2)` - ูุฏุนู ุฃุฑูุงู ุญุชู 99,999,999.99
- ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: `0`
- **ุงูููุชุฌุงุช ุงูุญุงููุฉ**: ุณุชุญุตู ุชููุงุฆูุงู ุนูู ุณุนุฑ 0

### Orders Table
```sql
ALTER TABLE orders 
ADD COLUMN shipping DECIMAL(10,2) NULL 
COMMENT 'ูุตุงุฑูู ุงูุดุญู';
```

**ุงูุฎุตุงุฆุต:**
- ุงูููุน: `DECIMAL(10,2)`
- **nullable**: ูููู ุชุฑูู ูุงุฑุบุงู
- ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: `NULL`
- **ุงูุทูุจุงุช ุงูุญุงููุฉ**: ุณุชุจูู ุจุฏูู ูููุฉ ุดุญู (NULL)

---

## ๐ ุชุดุบูู Migrations

### ุชููุงุฆูุงู (ุนูุฏ Deploy)
ุณูุชู ุชุดุบูู Migrations ุชููุงุฆูุงู ุฅุฐุง ูุงู ูุฏูู:
```json
{
  "scripts": {
    "start": "npm run db:migrate && node src/server.js"
  }
}
```

### ูุฏููุงู
```bash
npm run db:migrate
```

**Migrations ุงููุถุงูุฉ:**
- `20251023160100-add-price-to-products.js`
- `20251023160200-add-shipping-to-orders.js`

---

## ๐ก API Updates

### Products Endpoints

#### ุฅูุดุงุก ููุชุฌ (ูุน ุงูุณุนุฑ)
```http
POST /api/products
Content-Type: application/json
Authorization: Bearer {token}

{
  "code": "PROD123",
  "name": "ููุชุฌ ุชุฌุฑูุจู",
  "price": 150.50,
  "count": 100
}
```

#### ุชุญุฏูุซ ููุชุฌ (ุชุนุฏูู ุงูุณุนุฑ)
```http
PUT /api/products/:id
Content-Type: application/json
Authorization: Bearer {token}

{
  "name": "ููุชุฌ ูุญุฏุซ",
  "price": 175.00,
  "count": 50
}
```

#### Response
```json
{
  "success": true,
  "data": {
    "id": 1,
    "code": "PROD123",
    "name": "ููุชุฌ ุชุฌุฑูุจู",
    "price": "150.50",
    "count": 100,
    "order_by": 0
  },
  "message": "Product created successfully",
  "timestamp": "2024-10-23T16:00:00.000Z"
}
```

---

### Orders Endpoints

#### ุฅูุดุงุก ุทูุจ (ูุน ุงูุดุญู)
```http
POST /api/orders
Content-Type: application/json
Authorization: Bearer {token}

{
  "customer_name": "ุฃุญูุฏ ูุญูุฏ",
  "phone": "01234567890",
  "address": "ุงููุงูุฑุฉ",
  "city": "Cairo",
  "total": 500.00,
  "shipping": 50.00,
  "marketer_id": 1,
  "details": [
    {
      "product_id": 1,
      "quantity": 2,
      "price": 250.00
    }
  ]
}
```

#### ุฅูุดุงุก ุทูุจ (ุจุฏูู ุดุญู)
```http
POST /api/orders
Content-Type: application/json
Authorization: Bearer {token}

{
  "customer_name": "ุฃุญูุฏ ูุญูุฏ",
  "phone": "01234567890",
  "total": 500.00
  // shipping ุบูุฑ ูุทููุจ - ูููู ุชุฑูู
}
```

#### ุชุญุฏูุซ ุทูุจ (ุฅุถุงูุฉ/ุชุนุฏูู ุงูุดุญู)
```http
PUT /api/orders/:id
Content-Type: application/json
Authorization: Bearer {token}

{
  "shipping": 75.00
}
```

#### Response
```json
{
  "success": true,
  "data": {
    "id": 123,
    "order_code": "ORD-123",
    "customer_name": "ุฃุญูุฏ ูุญูุฏ",
    "phone": "01234567890",
    "total": "500.00",
    "shipping": "50.00",
    "status": "pending",
    "created_at": "2024-10-23T16:00:00.000Z"
  },
  "message": "Order created successfully",
  "timestamp": "2024-10-23T16:00:00.000Z"
}
```

---

## โ Validation Rules

### Product Price
- **ููุน ุงูุจูุงูุงุช**: Number (Float)
- **ุงููููุฉ ุงูุฏููุง**: 0
- **ุงุฎุชูุงุฑู**: ูุนู (ุฅุฐุง ูู ููุฑุณูุ ุณูููู 0)
- **ุฃูุซูุฉ ุตุญูุญุฉ**: `0`, `10.5`, `150`, `1999.99`
- **ุฃูุซูุฉ ุฎุงุทุฆุฉ**: `-10`, `"abc"`, `null`

### Order Shipping
- **ููุน ุงูุจูุงูุงุช**: Number (Float) ุฃู NULL
- **ุงููููุฉ ุงูุฏููุง**: 0 (ุฅุฐุง ุชู ุฅุฑุณุงููุง)
- **ุงุฎุชูุงุฑู**: ูุนู (ูููู ุชุฑูู ูุงุฑุบุงู)
- **ุฃูุซูุฉ ุตุญูุญุฉ**: `null`, `0`, `25.5`, `100`
- **ุฃูุซูุฉ ุฎุงุทุฆุฉ**: `-10`, `"free"`

---

## ๐ Rollback (ุฅุฐุง ุงุญุชุฌุช)

ูุฅูุบุงุก ุงูุชุญุฏูุซุงุช:
```bash
npm run db:migrate:undo
npm run db:migrate:undo
```

ุณูููู ุจุญุฐู ุงูุญููู ุจุชุฑุชูุจ ุนูุณู:
1. ุญุฐู `shipping` ูู Orders
2. ุญุฐู `price` ูู Products

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซุงุช

### 1. ุงูุชุญูู ูู Products
```bash
# ุฅูุดุงุก ููุชุฌ ุจุณุนุฑ
curl -X POST http://localhost:3000/api/products \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "code": "TEST001",
    "name": "ููุชุฌ ุงุฎุชุจุงุฑ",
    "price": 99.99,
    "count": 10
  }'
```

### 2. ุงูุชุญูู ูู Orders ูุน ุงูุดุญู
```bash
# ุฅูุดุงุก ุทูุจ ูุน ุดุญู
curl -X POST http://localhost:3000/api/orders \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "customer_name": "ุงุฎุชุจุงุฑ",
    "phone": "01234567890",
    "total": 200.00,
    "shipping": 30.00,
    "marketer_id": 1
  }'
```

### 3. ุงูุชุญูู ูู Orders ุจุฏูู ุดุญู
```bash
# ุฅูุดุงุก ุทูุจ ุจุฏูู ุดุญู
curl -X POST http://localhost:3000/api/orders \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -d '{
    "customer_name": "ุงุฎุชุจุงุฑ",
    "phone": "01234567890",
    "total": 200.00,
    "marketer_id": 1
  }'
```

---

## ๐ ุชุฃุซูุฑ ุนูู ุงูุจูุงูุงุช ุงูุญุงููุฉ

### Products
โ **ุขูู ุชูุงูุงู**
- ุฌููุน ุงูููุชุฌุงุช ุงูุญุงููุฉ ุณุชุญุตู ุนูู `price = 0`
- ูู ูุญุฏุซ ุฃู ุฎุทุฃ
- ููููู ุชุญุฏูุซ ุงูุฃุณุนุงุฑ ูุงุญูุงู

### Orders
โ **ุขูู ุชูุงูุงู**
- ุฌููุน ุงูุทูุจุงุช ุงูุญุงููุฉ ุณูููู `shipping = NULL`
- ูู ูุคุซุฑ ุนูู ุงูุญุณุงุจุงุช ุงูููุฌูุฏุฉ
- `total` ูุจูู ููุง ูู

---

## ๐ก ุญุงูุงุช ุงูุงุณุชุฎุฏุงู

### 1. ููุชุฌ ุจุณุนุฑ ุซุงุจุช
```json
{
  "code": "SHIRT-001",
  "name": "ูููุต ูุทู",
  "price": 150.00,
  "count": 50
}
```

### 2. ููุชุฌ ูุฌุงูู (ูุฏูุฉ)
```json
{
  "code": "GIFT-001",
  "name": "ูุฏูุฉ",
  "price": 0,
  "count": 10
}
```

### 3. ุทูุจ ุจุดุญู ูุฌุงูู
```json
{
  "customer_name": "ุนูู",
  "phone": "01111111111",
  "total": 500.00,
  "shipping": 0
}
```

### 4. ุทูุจ ุจุฏูู ูุนูููุงุช ุดุญู (ุณูุชู ุชุญุฏูุฏูุง ูุงุญูุงู)
```json
{
  "customer_name": "ุนูู",
  "phone": "01111111111",
  "total": 500.00
  // ูุง ุชูุฌุฏ ูููุฉ shipping
}
```

---

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ููู Backend
1. โ ุชู ุชูููุฐ Migrations
2. โ ุชู ุชุญุฏูุซ Models
3. โ ุชู ุชุญุฏูุซ Validators
4. โญ๏ธ ููููู ุงูุจุฏุก ูู ุงุณุชุฎุฏุงู ุงูุญููู ุงูุฌุฏูุฏุฉ

### ููู Frontend (Flutter)
1. ุฅุถุงูุฉ ุญูู `price` ูู Product model
2. ุฅุถุงูุฉ ุญูู `shipping` ูู Order model
3. ุชุญุฏูุซ UI ูุฅุฏุฎุงู ุงูุณุนุฑ ุนูุฏ ุฅูุดุงุก/ุชุนุฏูู ููุชุฌ
4. ุชุญุฏูุซ UI ูุฅุฏุฎุงู ุงูุดุญู (ุงุฎุชูุงุฑู) ุนูุฏ ุฅูุดุงุก/ุชุนุฏูู ุทูุจ
5. ุชุญุฏูุซ ุญุณุงุจุงุช ุงูููุงุชูุฑ ูุชุดูู ุงูุดุญู

---

## โ ุฃุณุฆูุฉ ุดุงุฆุนุฉ

### Q: ูุงุฐุง ูุญุฏุซ ููููุชุฌุงุช ุงูุญุงููุฉุ
**A:** ุฌููุน ุงูููุชุฌุงุช ุงูุญุงููุฉ ุณุชุญุตู ุชููุงุฆูุงู ุนูู `price = 0`. ููููู ุชุญุฏูุซูุง ูุฏููุงู ุฃู ุนุจุฑ API.

### Q: ูู ูุฌุจ ุฅุถุงูุฉ shipping ูู ูู ุทูุจุ
**A:** ูุงุ ุญูู shipping ุงุฎุชูุงุฑู ุชูุงูุงู. ููููู ุชุฑูู ูุงุฑุบุงู ุฃู ุฅุถุงูุฉ ูููุฉ ูู.

### Q: ููู ุฃุญุณุจ ุงูุฅุฌูุงูู ุงูููุงุฆู ูุน ุงูุดุญูุ
**A:** 
```
ุฅุฌูุงูู ุงูุทูุจ ุงูููุงุฆู = total + shipping (ุฅุฐุง ูุงู shipping ููุฌูุฏ)
```

### Q: ูู ูููู ุฃู ูููู ุงูุณุนุฑ ุณุงูุจุงูุ
**A:** ูุงุ ุงูู validation ูุง ูุณูุญ ุจููู ุณุงูุจุฉ ููุณุนุฑ ุฃู ุงูุดุญู.

---

**ุชู ุงูุชุญุฏูุซ:** 23 ุฃูุชูุจุฑ 2024  
**ุงูุฅุตุฏุงุฑ:** 1.0.0
